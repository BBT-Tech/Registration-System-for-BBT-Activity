webpackJsonp([6],{"8Dt7":function(t,e){},xJsL:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"input-tips"},[i("div",{staticClass:"title"},[t._t("title")],2),t._v(" "),i("input",{attrs:{type:t.type,spellcheck:"false"},domProps:{value:t.value},on:{input:function(e){t.$emit("input",e.target.value)},focus:function(e){t.inputting=!0},blur:function(e){t.inputting=!1}}}),t._v(" "),i("div",{staticClass:"error"},[!t.inputting&&t.errWhen?t._t("tips"):t._e()],2)])},staticRenderFns:[]};var s={name:"Login",components:{"input-tips":i("VU/8")({name:"InputTips",props:["value","type","errWhen"],data:function(){return{inputting:!0}}},n,!1,function(t){i("xkaM")},"data-v-bf6ff6e2",null).exports},data:function(){return{studentId:"",password:"",loading:!1}},beforeRouteEnter:function(t,e,i){t.meta.logined?i({path:"/activity",replace:!0}):i()},beforeRouteLeave:function(t,e,i){"Login"!==t.name?t.meta.logined?(this.$emit("main-fade-out"),setTimeout(function(){i()},200)):i(!1):i()},created:function(){var t=this;setTimeout(function(){t.$emit("main-fade-in")},200)},mounted:function(){window.addEventListener("keydown",this.pressEnter)},computed:{isIdValid:function(){return-1!==this.studentId.search(/^\d{12}$/)},isPswValid:function(){return""!==this.password},isValid:function(){return this.isIdValid&&this.isPswValid}},methods:{login:function(){if(this.isValid){var t=this;t.loading=!0,t.$http.post(t.$global.urls.login(),{student_id:t.studentId,password:t.password}).then(function(e){(e=e.body)instanceof Object?e.err_code>0?alert(e.err_msg):e.err_code<0?confirm(e.err_msg)&&(window.location.href="https://hemc.100steps.net/2013/bbter/users"):(e=e.data,t.$route.meta.logined=!0,t.$route.meta.studentId=t.studentId,t.$route.meta.name=e.name,t.$route.meta.isManager=e.is_manager,window.removeEventListener("keydown",t.pressEnter),t.$route.meta.loginToRedirect?(t.$root.$router.replace(t.$route.meta.loginRedirectPath),t.$route.meta.loginToRedirect=!1):t.$root.$router.replace("/activity")):alert("服务器发生错误"),t.loading=!1}).catch(function(e){alert("404！该服务暂时不可用"),t.loading=!1})}},pressEnter:function(t){13===(t.keyCode||t.charCode)&&this.isIdValid&&this.isPswValid&&this.login()}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"login"},[t._m(0),t._v(" "),i("div",{staticClass:"input-box"},[i("input-tips",{staticClass:"login-input",attrs:{"err-when":!t.isIdValid},model:{value:t.studentId,callback:function(e){t.studentId=e},expression:"studentId"}},[i("template",{slot:"title"},[t._v("学号")]),t._v(" "),i("div",{attrs:{slot:"tips"},slot:"tips"},[t._v("学号不符合格式")])],2),t._v(" "),i("input-tips",{staticClass:"login-input",attrs:{type:"password","err-when":!t.isPswValid},model:{value:t.password,callback:function(e){t.password=e},expression:"password"}},[i("template",{slot:"title"},[t._v("密码")]),t._v(" "),i("div",{attrs:{slot:"tips"},slot:"tips"},[t._v("密码不能为空")])],2)],1),t._v(" "),i("div",{staticClass:"button",class:{"button-dis":!t.isIdValid||!t.isPswValid||t.loading},on:{click:t.login}},[i("div",{staticClass:"button-text"},[t._v("登 录")])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"title-box"},[e("div",{staticClass:"title"},[e("div",[this._v("百步梯")]),this._v(" "),e("div",[this._v("福利报名系统")])])])}]};var o=i("VU/8")(s,a,!1,function(t){i("8Dt7")},"data-v-034a7c7c",null);e.default=o.exports},xkaM:function(t,e){}});
//# sourceMappingURL=6.baa754cb0aec4d420d6c.js.map