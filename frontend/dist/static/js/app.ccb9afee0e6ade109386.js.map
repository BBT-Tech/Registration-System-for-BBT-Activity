{"version":3,"sources":["webpack:///./src/router/index.js","webpack:///./src/App.vue?8e8c","webpack:///./src/App.vue","webpack:///src/App.vue","webpack:///./src/main.js"],"names":["vue_esm","use","vue_router_esm","router","routes","path","name","component","Promise","all","__webpack_require__","e","then","bind","redirect","selectortype_template_index_0_src_App","render","_h","this","$createElement","_c","_self","attrs","id","staticRenderFns","src_App","normalizeComponent","vue_resource_esm","config","productionTip","data","logined","studengId","isManager","departmentList","components","App","template","beforeCreate","vm","$http","post","body","Object","err_code","alert","err_msg","studentId","student_id","is_manager","$router","history","current","replace","search","type","start_id","$route","params","number","promise_default","a","reject","activities","Array","length","Number","activity","timeAccess","compareDatetime","action_time","book_time","is_publisher","catch","$mount","methods","datetime","now","Date","comparison","slice","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","i","datetimeToInput","inputToDatetime","input"],"mappings":"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","file":"static/js/app.ccb9afee0e6ade109386.js","sourcesContent":["import Vue from 'vue'\nimport Router from 'vue-router'\nconst Login = () => import('@/components/Login')\nconst Activity = () => import('@/components/Activity')\nconst ActivityDetails = () => import('@/components/ActivityDetails')\nconst ActivityCreator = () => import('@/components/ActivityCreator')\nconst ActivityEditor = () => import('@/components/ActivityEditor')\n\nVue.use(Router)\n\nexport default new Router({\n  routes: [\n    {\n      path: '/login',\n      name: 'Login',\n      component: Login\n    },\n    {\n      path: '/activity/publish',\n      name: 'ActivityCreator',\n      component: ActivityCreator\n    },\n    {\n      path: '/activity/:id/edit',\n      name: 'ActivityEditor',\n      component: ActivityEditor\n    },\n    {\n      path: '/activity/:id',\n      name: 'ActivityDetails',\n      component: ActivityDetails\n    },\n    {\n      path: '/activity',\n      name: 'Activity',\n      component: Activity\n    },\n    {\n      path: '*',\n      redirect: '/login'\n    }\n  ]\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/router/index.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('router-view')],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1e386d4c\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport __vue_template__ from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1e386d4c\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","<template>\n  <div id=\"app\">\n    <router-view/>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'App'\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","// The Vue build version to load with the `import` command\n// (runtime-only or standalone) has been set in webpack.base.conf with an alias.\nimport Vue from 'vue'\nimport router from './router'\nimport VueResource from 'vue-resource'\n\nimport App from './App'\n\nVue.use(VueResource)\nVue.config.productionTip = false\n\n/* eslint-disable no-new */\nnew Vue({\n  data: {\n    logined: false,\n    studengId: '',\n    name: '',\n    isManager: false,\n    departmentList: [\n      '编辑部',\n      '综合管理部',\n      '综合新闻部',\n      '外联部',\n      '策划推广部',\n      '节目部',\n      '人力资源部',\n      '技术部',\n      '视频部',\n      '视觉设计部'\n    ]\n  },\n  router,\n  components: {App},\n  template: '<App/>',\n  beforeCreate () {\n    var vm = this\n    vm.$http.post('/api/init.php').then(data => {\n      data = data.body\n      if (!(data instanceof Object)) {\n        alert('服务器发生错误')\n      } else if (data.err_code) {\n        alert(data.err_msg)\n      } else {\n        data = data.data\n        if (data.logined) {\n          vm.logined = true\n          vm.studentId = data.student_id\n          vm.name = data.name\n          vm.isManager = data.is_manager\n        }\n      }\n      var path = vm.$router.history.current.path\n      if (path === '/login') {\n        if (vm.logined) {\n          vm.$router.replace('/activity')\n        }\n      } else {\n        if (!vm.logined) {\n          vm.$router.replace('/login')\n        } else if (path.search(/^\\/activity\\/\\d+\\/edit$/) !== -1) {\n          vm.$http.post('/api/get-activity.php', {\n            type: 0,\n            start_id: vm.$route.params.id,\n            number: 1\n          }).then(data => {\n            data = data.body\n            if (!(data instanceof Object)) {\n              return Promise.reject('服务器发生错误')\n            } else if (data.err_code) {\n              return Promise.reject(data.err_msg)\n            } else {\n              data = data.data\n              if (data.activities instanceof Array &&\n                data.activities.length === 1 &&\n                data.activities[0].id === Number(vm.$route.params.id)) {\n                let activity = data.activities[0]\n                let timeAccess = false\n                if (activity.type === 0) {\n                  timeAccess = vm.compareDatetime(activity.action_time) > 0\n                } else if (activity.type === 1) {\n                  timeAccess = vm.compareDatetime(activity.book_time) > 0\n                }\n                if (!(timeAccess && activity.is_publisher)) {\n                  return Promise.reject('你没有修改权限')\n                }\n              } else {\n                return Promise.reject('活动不存在')\n              }\n            }\n          }).catch(data => {\n            if (typeof data === 'string') {\n              alert(data)\n            } else {\n              alert('服务器发生错误')\n              vm.$router.replace('/activity/' + vm.$route.params.id)\n            }\n          })\n        }\n      }\n      vm.$mount('#app')\n    })\n  },\n  methods: {\n    compareDatetime (datetime) {\n      var now = new Date()\n      var comparison = [\n        [datetime.slice(0, 4), now.getFullYear()],\n        [datetime.slice(5, 7), now.getMonth() + 1],\n        [datetime.slice(8, 10), now.getDate()],\n        [datetime.slice(11, 13), now.getHours()],\n        [datetime.slice(14, 16), now.getMinutes()],\n        [datetime.slice(17, 19), now.getSeconds()]\n      ]\n      for (let i = 0; i < 6; i++) {\n        comparison[i][0] = Number(comparison[i][0])\n        if (comparison[i][0] !== comparison[i][1]) {\n          return comparison[i][0] - comparison[i][1]\n        }\n      }\n      return 0\n    },\n    datetimeToInput (datetime) {\n      return datetime.replace(/^(\\d{4}-\\d{2}-\\d{2}) (\\d{2}:\\d{2}):\\d{2}$/, '$1T$2')\n    },\n    inputToDatetime (input) {\n      return input.slice(0, 10) + ' ' + input.slice(11) + ':00'\n    }\n  }\n})\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}