webpackJsonp([7],{0:function(e,t){},NHnr:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("//Fk"),r=n.n(i),a=n("7+uW"),o=n("/ocq");a.a.use(o.a);var c=new o.a({routes:[{path:"/login",name:"Login",component:function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,"xJsL"))}},{path:"/activity/publish",name:"ActivityCreator",component:function(){return Promise.all([n.e(0),n.e(4)]).then(n.bind(null,"R+vx"))}},{path:"/activity/:id/edit",name:"ActivityEditor",component:function(){return Promise.all([n.e(0),n.e(1)]).then(n.bind(null,"1UK+"))}},{path:"/activity/:id",name:"ActivityDetails",component:function(){return n.e(2).then(n.bind(null,"GYYd"))}},{path:"/activity",name:"Activity",component:function(){return n.e(3).then(n.bind(null,"pGKz"))}},{path:"*",redirect:"/login"}]}),u=n("8+8L"),s={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]},p=n("VU/8")({name:"App"},s,!1,null,null,null).exports;a.a.use(u.a),a.a.config.productionTip=!1,new a.a({data:{logined:!1,studengId:"",name:"",isManager:!1,departmentList:["编辑部","综合管理部","综合新闻部","外联部","策划推广部","节目部","人力资源部","技术部","视频部","视觉设计部"]},router:c,components:{App:p},template:"<App/>",beforeCreate:function(){var e=this;e.$http.post("/api/init.php").then(function(t){(t=t.body)instanceof Object?t.err_code?alert(t.err_msg):(t=t.data).logined&&(e.logined=!0,e.studentId=t.student_id,e.name=t.name,e.isManager=t.is_manager):alert("服务器发生错误");var n=e.$router.history.current.path;"/login"===n?e.logined&&e.$router.replace("/activity"):e.logined?-1!==n.search(/^\/activity\/\d+\/edit$/)&&e.$http.post("/api/get-activity.php",{type:0,start_id:e.$route.params.id,number:1}).then(function(t){if(!((t=t.body)instanceof Object))return r.a.reject("服务器发生错误");if(t.err_code)return r.a.reject(t.err_msg);if(!((t=t.data).activities instanceof Array&&1===t.activities.length&&t.activities[0].id===Number(e.$route.params.id)))return r.a.reject("活动不存在");var n=t.activities[0],i=!1;return 0===n.type?i=e.compareDatetime(n.action_time)>0:1===n.type&&(i=e.compareDatetime(n.book_time)>0),i&&n.is_publisher?void 0:r.a.reject("你没有修改权限")}).catch(function(t){"string"==typeof t?alert(t):(alert("服务器发生错误"),e.$router.replace("/activity/"+e.$route.params.id))}):e.$router.replace("/login"),e.$mount("#app")})},methods:{compareDatetime:function(e){for(var t=new Date,n=[[e.slice(0,4),t.getFullYear()],[e.slice(5,7),t.getMonth()+1],[e.slice(8,10),t.getDate()],[e.slice(11,13),t.getHours()],[e.slice(14,16),t.getMinutes()],[e.slice(17,19),t.getSeconds()]],i=0;i<6;i++)if(n[i][0]=Number(n[i][0]),n[i][0]!==n[i][1])return n[i][0]-n[i][1];return 0},datetimeToInput:function(e){return e.replace(/^(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}):\d{2}$/,"$1T$2")},inputToDatetime:function(e){return e.slice(0,10)+" "+e.slice(11)+":00"}}})}},["NHnr"]);
//# sourceMappingURL=app.ccb9afee0e6ade109386.js.map