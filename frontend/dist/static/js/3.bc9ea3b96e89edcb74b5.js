webpackJsonp([3],{pGKz:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"activity-bar",class:{"activity-error":t.isError},on:{click:function(e){t.$root.$router.push("/activity/"+t.data.id)}}},[0===t.data.type?i("div",[i("div",[t._v("志愿活动标题："+t._s(t.data.title))]),t._v(" "),i("div",[t._v("详情："+t._s(t.data.details))]),t._v(" "),i("div",[t._v("志愿开始时间："+t._s(t.data.action_time))]),t._v(" "),i("div",[t._v("已报名人数："+t._s(t.data.current_member)+"/"+t._s(t.data.member))]),t._v(" "),t.$root.compareDatetime(t.data.action_time)<0?i("div",{staticClass:"activity-error-tip"},[t._v("活动已开始，不予报名")]):t.data.member===t.data.current_member?i("div",{staticClass:"activity-error-tip"},[t._v("报名人数已满")]):t._e()]):1===t.data.type?i("div",[i("div",[t._v("福利活动标题："+t._s(t.data.title))]),t._v(" "),i("div",[t._v("详情："+t._s(t.data.details))]),t._v(" "),i("div",[t._v("领取时间："+t._s(t.data.book_time))]),t._v(" "),i("div",[t._v("已领取人数："+t._s(t.data.current_member)+"/"+t._s(t.data.award))]),t._v(" "),t.$root.compareDatetime(t.data.book_time)>=0?i("div",{staticClass:"activity-error-tip"},[t._v("领奖时间未到")]):t.data.award===t.data.current_member?i("div",{staticClass:"activity-error-tip"},[t._v("奖品已被领完")]):t.data.is_department_full?i("div",{staticClass:"activity-error-tip"},[t._v("所在部门领取人数已满")]):t._e()]):t._e()])},staticRenderFns:[]};var r={name:"Activity",components:{"activity-bar":i("VU/8")({name:"ActivityBar",props:["data"],data:function(){return{usedData:this.data}},computed:{isError:function(){var t=this.usedData;return 0===t.type?t.member===t.current_member||this.$root.compareDatetime(t.action_time)<0:1===t.type?t.is_department_full||t.award===t.current_member||this.$root.compareDatetime(t.book_time)>=0:void 0}}},a,!1,function(t){i("ya4Q")},"data-v-c688f2a6",null).exports},beforeCreate:function(){this.$root.logined||this.$root.$router.replace("/login")},created:function(){this.$root.logined&&this.getActivity()},data:function(){return{queryTypes:[{name:"所有活动",type:0},{name:"未参与的",type:1},{name:"我参与的",type:2},{name:"我发起的",type:3}],currentQueryType:0,currentStartId:0,queryNumber:5,isQueryEnd:!0,loading:!1,activities:[]}},methods:{signout:function(){var t=this;t.$http.post("/api/signout.php").then(function(e){(e=e.body)instanceof Object?e.err_code?alert(e.err_msg):(t.$root.logined=!1,t.$root.studentId="",t.$root.name="",t.$root.isManager=!1,t.$root.$router.replace("/login")):alert("服务器发生错误")}).catch(function(e){alert("404！该服务暂时不可用"),t.saving=!1})},getActivity:function(){var t=this;t.loading=!0,t.$http.post("/api/get-activity.php",{type:t.currentQueryType,start_id:t.currentStartId,number:t.queryNumber}).then(function(e){(e=e.body)instanceof Object?e.err_code?alert(e.err_msg):(e=e.data,t.activities=t.activities.concat(e.activities),t.currentStartId=e.activities.slice(-1)[0].id-1,t.isQueryEnd=e.is_end):alert("服务器发生错误"),t.loading=!1}).catch(function(e){alert("404！该服务暂时不可用"),t.saving=!1})},flushActivity:function(t){this.currentQueryType!==t&&(this.currentQueryType=t,this.activities=[],this.currentStartId=0,this.isQueryEnd=!0,this.getActivity())}}},n={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("button",{on:{click:t.signout}},[t._v("退出")]),t._v(" "),t.$root.isManager?i("button",{on:{click:function(e){t.$root.$router.push("/activity/publish")}}},[t._v("添加活动")]):t._e(),t._v(" "),i("br"),t._v(" "),t._l(t.queryTypes,function(e){return 3!==e.type||t.$root.isManager?i("span",{key:"queryActivity"+e.type,staticClass:"button",class:{"button-active":t.currentQueryType===e.type},on:{click:function(i){t.flushActivity(e.type)}}},[t._v(t._s(e.name))]):t._e()}),t._v(" "),i("br"),t._v(" "),t._l(t.activities,function(t){return i("activity-bar",{key:"activity"+t.id,attrs:{data:t}})}),t._v(" "),t.isQueryEnd||t.loading?t._e():i("button",{on:{click:t.getActivity}},[t._v("查看更多")]),t._v(" "),t.loading?i("span",[t._v("Loading...")]):t._e()],2)},staticRenderFns:[]};var o=i("VU/8")(r,n,!1,function(t){i("pN3C")},"data-v-1be50160",null);e.default=o.exports},pN3C:function(t,e){},ya4Q:function(t,e){}});
//# sourceMappingURL=3.bc9ea3b96e89edcb74b5.js.map