webpackJsonp([8],{0:function(e,t){},NHnr:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i("//Fk"),r=i.n(n),a=i("7+uW"),u=i("/ocq");a.a.use(u.a);var o=new u.a({routes:[{path:"/login",name:"Login",component:function(){return i.e(6).then(i.bind(null,"xJsL"))}},{path:"/activity",component:function(){return Promise.all([i.e(0),i.e(4)]).then(i.bind(null,"pGKz"))},children:[{path:"",name:"ActivityHome",component:function(){return Promise.all([i.e(0),i.e(5)]).then(i.bind(null,"cqKU"))},meta:{queryTypes:["所有","我参与","未参与"]}},{path:"publish",name:"ActivityCreator",component:function(){return i.e(2).then(i.bind(null,"R+vx"))},meta:{queryTypes:["发起活动"]}},{path:":id/edit",name:"ActivityEditor",component:function(){return i.e(1).then(i.bind(null,"1UK+"))},meta:{queryTypes:["修改活动"]}},{path:":id",name:"ActivityDetails",component:function(){return Promise.all([i.e(0),i.e(3)]).then(i.bind(null,"GYYd"))},meta:{queryTypes:["活动详情","各部门情况"]}}]},{path:"*",redirect:"/login"}]}),d=i("8+8L"),s={logined:!1,studengId:"",name:"",isManager:!1,departmentList:["编辑部","综合管理部","综合新闻部","外联部","策划推广部","节目部","人力资源部","技术部","视频部","视觉设计部"],urls:{front:"/",add:function(e){return this.front+e},init:function(){return this.add("api/init.php")},login:function(){return this.add("api/login.php")},signout:function(){return this.add("api/signout.php")},publishV:function(){return this.add("api/manager/publish/volunteer")},publishA:function(){return this.add("api/manager/publish/award")},image:function(e){return this.add("api/publisher/modify/image/"+e)},queryA:function(){return this.add("api/get-activity.php")},queryD:function(e){return this.add("api/department.php?id="+e)},queryU:function(e){return this.add("api/get-department-user.php?id="+e)},download:function(e){return this.add("api/manager/download/"+e)},register:function(e){return this.add("api/user/register/"+e)},unregister:function(e){return this.add("api/user/unregister/"+e)},editV:function(e){return this.add("api/publisher/modify/volunteer/"+e)},editA:function(e){return this.add("api/publisher/modify/award/"+e)},delete:function(e){return this.add("api/publisher/delete/"+e)}},getCookie:function(e){var t=new RegExp("(?:(?:^|.*;\\s*)"+e+"\\s*=\\s*([^;]*).*$)|^.*$");return document.cookie.replace(t,"$1")},removeCookie:function(e){var t=new Date;t.setTime(t.getTime()-1),document.cookie=e+"=;expires="+t.toUTCString()},compareDatetime:function(e){for(var t=new Date,i=[[e.slice(0,4),t.getFullYear()],[e.slice(5,7),t.getMonth()+1],[e.slice(8,10),t.getDate()],[e.slice(11,13),t.getHours()],[e.slice(14,16),t.getMinutes()],[e.slice(17,19),t.getSeconds()]],n=0;n<6;n++)if(i[n][0]=Number(i[n][0]),i[n][0]!==i[n][1])return i[n][0]-i[n][1];return 0},datetimeToInput:function(e){return e.replace(/^(\d{4}-\d{2}-\d{2}) (\d{2}:\d{2}):\d{2}$/,"$1T$2")},inputToDatetime:function(e){return e.slice(0,10)+" "+e.slice(11)+":00"}},c={name:"App",data:function(){return{appWidth:void 0}},created:function(){this.flushSize(),window.addEventListener("resize",this.flushSize)},methods:{flushSize:function(){var e=document.body.clientWidth;e<300?e=300:e>450&&(e=450),this.appWidth=e/1080*100}}},p={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("div",{attrs:{id:"global-bg"}}),this._v(" "),t("router-view",{style:{fontSize:this.appWidth+"px"}})],1)},staticRenderFns:[]};var l,h=i("VU/8")(c,p,!1,function(e){i("Zmw1")},null,null).exports;a.a.use(d.a),a.a.config.productionTip=!1,a.a.prototype.$global=s,o.beforeEach((l=!1,function(e,t,i){l||(l=!0,a.a.http.post(s.urls.init()).then(function(t){if(!((t=t.body)instanceof Object))return r.a.reject("服务器发生错误");if(t.err_code)return r.a.reject(t.err_msg);if((t=t.data).logined&&(s.logined=!0,s.studentId=t.student_id,s.name=t.name,s.isManager=t.is_manager),"/login"===e.fullPath)s.logined&&i({path:"/activity"});else if(s.logined){if(-1!==e.fullPath.search(/^\/activity\/\d+\/edit$/))return a.a.http.post(s.urls.queryA(),{type:0,start_id:e.params.id,number:1})}else i({path:"/login"});return r.a.reject(0)}).then(function(t){if(!((t=t.body)instanceof Object))return r.a.reject("服务器发生错误");if(t.err_code)return r.a.reject(t.err_msg);if(!((t=t.data).activities instanceof Array&&1===t.activities.length&&t.activities[0].id===Number(e.params.id)))return r.a.reject("活动不存在");var i=t.activities[0],n=!1;return 0===i.type?n=s.compareDatetime(i.action_time)>0:1===i.type&&(n=s.compareDatetime(i.book_time)>0),n&&i.is_publisher?void 0:r.a.reject("你没有修改权限")}).catch(function(t){0===t||("string"==typeof t?alert(t):(alert("服务器发生错误"),i({path:"/activity/"+e.params.id})))})),i()})),new a.a({el:"#app",router:o,components:{App:h},template:"<App/>"})},Zmw1:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.ceec5e388511a939f074.js.map